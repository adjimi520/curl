name: Node.js CI

on:
    push:
        branches: ['main'] # 只在 main 分支推送时触发
    pull_request:
        branches: ['*'] # 对所有 PR 触发

jobs:
    build-and-test:
        runs-on: ubuntu-latest
        steps:
            # 1. 检出代码
            - name: Checkout repository
              uses: actions/checkout@v3

            # 2. 设置 Node.js 环境
            - name: Setup Node.js
              uses: actions/setup-node@v3
              with:
                  node-version: '20' # 指定 Node.js 版本（如 18、20、latest）
                  cache: 'npm' # 缓存 npm 依赖，加速后续构建

            # 3. 安装依赖
            - name: Install dependencies
              run:
                  - npm ci

            # 4. 运行测试
            - name: Run tests
              run:
                  - echo '------------------------------------------'
                  - pwd
                  - node curl.js
                  - echo '-------------------------------------------'
